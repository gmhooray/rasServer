<!doctype html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Test</title>
    <script src="js/jquery.min.js"></script>
    <script src="js/fotorama.js"></script>
    <link rel="stylesheet" href="css/fotorama.css"/>
    <link rel="stylesheet" href="css/style.css"/>
    <script>
        var sDir="files/test/";

        $(function () {
            // 1. Initialize fotorama manually.
            var $fotoramaDiv = $('#fotorama').on('fotorama:ready',
                    function (e, fotorama, extra) {
                        console.log('ready');
                    }
            ).on('fotorama:showend',
                    function (e, fotorama, extra) {
                        if( fotorama.activeIndex == fotorama.size - 3 && fotorama.size - 3 > 0){
                            getImage(fotorama.activeIndex, sDir);
                        }
                    }
            ).fotorama();

            // 2. Get the API object.
            var fotorama = $fotoramaDiv.data('fotorama');

            function getImage(nCurrentIndex, sDir){
                $.ajax({
                    type:'POST',
                    url: "/getList",
                    data: {index : nCurrentIndex}
                }).done(function(data){
                    console.log(data.aFilenames.length)
                    for(var i = 0; i < data.aFilenames.length; i++){
                        fotorama.push({img: sDir + data.aFilenames[i]});
                    }
                })
            }
            getImage(0, sDir)
        });

    </script>
</head>
<body>
<div id="wrap">
    <!-- Start : HEAD -->
    <div id="header"></div>
    <!-- End : HEAD -->
    <!-- Start : Container -->
    <div id="container">
        <div id="fotorama" class="fotorama" data-click="true" data-nav="false" data-width="100%" data-height="100%" data-auto="false" data-allowfullscreen="true">
            <!-- Image area -->
        </div>
    </div>
    <!-- End : Container -->
    <!-- Start : FOOTER -->
    <div id="footer"></div>
    <!-- End : FOOTER -->
</div>
<script>

</script>
<!--<script src="/socket.io/socket.io.js"></script>-->
<script>
    /*var socket = io($(location).attr('host'));
        var gEvent = function(){this.$init.apply(this,arguments)}

        gEvent.prototype = {
            $init:function(){
	            this._attachedEvent(socket);
            },
	        _attachedEvent: function(socket){
				this._ePressPrevKey(socket);
		        this._ePressNextKey(socket);
	        },
	        _ePressPrevKey:function(socket,sID){
                $('#btn_prev').on('click',function(){
					socket.emit('pushPrev',{key:'Prev'})
                });
            },
	        _ePressNextKey:function(socket,sID){
                $('#btn_next').on('click',function(){
	                socket.emit('pushNext',{key:'Next'})
                });
            }
        }

        $(document).ready(function(){
            new gEvent();
        })*/
</script>
</body>
</html>